FROM mcr.microsoft.com/dotnet/sdk:9.0 AS migration

# CrÃ©e un rÃ©pertoire pour l'app
WORKDIR /app

# Copie tout le code de l'API
COPY . .

# Restaure les packages
RUN dotnet restore "PortraitFr.API.csproj"

# Build (pour Ãªtre sÃ»r que tout est compilÃ©)
RUN dotnet build "PortraitFr.API.csproj" -c Release

# RÃ©installe les outils si besoin
RUN dotnet tool install --global dotnet-ef --version 9.0.3
ENV PATH="${PATH}:/root/.dotnet/tools"

# ðŸ‘‰ Ce conteneur lancera cette commande Ã  lâ€™exÃ©cution (overridable dans docker-compose)
ENTRYPOINT ["dotnet-ef"]
